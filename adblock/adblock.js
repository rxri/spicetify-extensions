"use strict";const loadWebpack=()=>{try{const o=window.webpackChunkclient_web.push([[Symbol()],{},n=>n]),s=Object.keys(o.m).map(n=>o(n)),i=s.filter(n=>typeof n=="object").flatMap(n=>{try{return Object.values(n)}catch{}}),r=new Set(Object.values(o.m)),c=i.flatMap(n=>typeof n=="function"?[n]:typeof n=="object"&&n?Object.values(n).filter(p=>typeof p=="function"&&!r.has(p)):[]);return{cache:s,functionModules:c}}catch(o){return console.error("adblockify: Failed to load webpack",o),{cache:[],functionModules:[]}}},getSettingsClient=(o,s=[],i={})=>{try{const r=o.find(c=>c?.settingsClient)?.settingsClient;if(!r){const c=s.find(n=>n?.SERVICE_ID==="spotify.ads.esperanto.settings.proto.Settings"||n?.SERVICE_ID==="spotify.ads.esperanto.proto.Settings");return new c(i)}return r}catch(r){return console.error("adblockify: Failed to get ads settings client",r),null}},getSlotsClient=(o,s)=>{try{const i=o.find(r=>r.SERVICE_ID==="spotify.ads.esperanto.slots.proto.Slots"||r.SERVICE_ID==="spotify.ads.esperanto.proto.Slots");return new i(s)}catch(i){return console.error("adblockify: Failed to get slots client",i),null}},getTestingClient=(o,s)=>{try{const i=o.find(r=>r.SERVICE_ID==="spotify.ads.esperanto.testing.proto.Testing"||r.SERVICE_ID==="spotify.ads.esperanto.proto.Testing");return new i(s)}catch(i){return console.error("adblockify: Failed to get testing client",i),null}},map=new Map,retryCounter=(o,s)=>{if(map.has(o)||map.set(o,{count:0}),s==="increment")map.get(o).count++;else if(s==="clear")map.delete(o);else if(s==="get")return map.get(o)?.count};(async function o(){await new Promise(e=>Spicetify.Events.platformLoaded.on(e)),await new Promise(e=>Spicetify.Events.webpackLoaded.on(e));const s=loadWebpack(),{Platform:i,Locale:r}=Spicetify,{AdManagers:c}=i;if(!c?.audio||Object.keys(c).length===0){setTimeout(o,100);return}const{audio:n}=c,{UserAPI:p}=i,u=p._product_state||p._product_state_service||i?.ProductStateAPI?.productStateApi,y=Spicetify.Platform.version.split(".").map(e=>Number.parseInt(e));if(!Spicetify?.CosmosAsync){setTimeout(o,100);return}const{CosmosAsync:b}=Spicetify;let f=[];const g=getSlotsClient(s.functionModules,u.transport);if(g)f=(await g.getSlots()).adSlots;else try{f=await b.get("sp://ads/v1/slots")}catch{setTimeout(o,100);return}const C=()=>{const e=document.createElement("style"),t=r.get("upgrade.tooltip.title");e.className="adblockify",e.innerHTML=`.Mvhjv8IKLGjQx94MVOgP, .sl_aPp6GDg05ItSfmsS7, .sl_aPp6GDg05ItSfmsS7, .nHCJskDZVlmDhNNS9Ixv, .utUDWsORU96S7boXm2Aq, .cpBP3znf6dhHLA2dywjy, .G7JYBeU1c2QawLyFs5VK, .vYl1kgf1_R18FCmHgdw2, .vZkc6VwrFz0EjVBuHGmx, .iVAZDcTm1XGjxwKlQisz, ._I_1HMbDnNlNAaViEnbp, .xXj7eFQ8SoDKYXy6L3E1, .F68SsPm8lZFktQ1lWsQz, .MnW5SczTcbdFHxLZ_Z8j, .WiPggcPDzbwGxoxwLWFf, .ReyA3uE3K7oEz7PTTnAn, .x8e0kqJPS0bM4dVK7ESH, .gZ2Nla3mdRREDCwybK6X, .SChMe0Tert7lmc5jqH01, .AwF4EfqLOIJ2xO7CjHoX, .UlkNeRDFoia4UDWtrOr4, .k_RKSQxa2u5_6KmcOoSw, ._mWmycP_WIvMNQdKoAFb, .O3UuqEx6ibrxyOJIdpdg, .akCwgJVf4B4ep6KYwrk5, .bIA4qeTh_LSwQJuVxDzl, .ajr9pah2nj_5cXrAofU_, .gvn0k6QI7Yl_A0u46hKn, .obTnuSx7ZKIIY1_fwJhe, .IiLMLyxs074DwmEH4x5b, .RJjM91y1EBycwhT_wH59, .mxn5B5ceO2ksvMlI1bYz, .l8wtkGVi89_AsA3nXDSR, .Th1XPPdXMnxNCDrYsnwb, .SJMBltbXfqUiByDAkUN_, .Nayn_JfAUsSO0EFapLuY, .YqlFpeC9yMVhGmd84Gdo, .HksuyUyj1n3aTnB4nHLd, .DT8FJnRKoRVWo77CPQbQ, ._Cq69xKZBtHaaeMZXIdk, .main-leaderboardComponent-container, .sponsor-container, a.link-subtle.main-navBar-navBarLink.GKnnhbExo0U9l7Jz2rdc, button[title="${t}"], button[aria-label="${t}"], .main-topBar-UpgradeButton, .main-contextMenu-menuItem a[href^="https://www.spotify.com/premium/"], div[data-testid*="hpto"] {display: none !important;}`,document.head.appendChild(e)},I=async()=>{try{await u.putOverridesValues({pairs:{ads:"0",catalogue:"premium",product:"premium",type:"premium"}})}catch(e){console.error("adblockify: Failed inside `disableAds` function\n",e)}},S=async()=>{try{const{billboard:e,leaderboard:t,sponsoredPlaylist:a}=c,l=getTestingClient(s.functionModules,u.transport);if(l?l.addPlaytime({seconds:-1e11}):await b.post("sp://ads/v1/testing/playtime",{value:-1e11}),await n.disable(),n.isNewAdsNpvEnabled=!1,await e.disable(),await t?.disableLeaderboard(),await a.disable(),c?.inStreamApi){const{inStreamApi:d}=c;await d.disable()}if(c?.vto){const{vto:d}=c;await d.manager.disable(),d.isNewAdsNpvEnabled=!1}setTimeout(I,100)}catch(e){console.error("adblockify: Failed inside `configureAdManagers` function\n",e)}},k=async()=>{for(const e of f)E(e.slotId||e.slot_id),setTimeout(()=>m({adSlotEvent:{slotId:e.slotId||e.slot_id}}),50)},m=e=>{const t=e?.adSlotEvent?.slotId;try{const a=n?.inStreamApi?.adsCoreConnector;typeof a?.clearSlot=="function"&&a.clearSlot(t);const l=getSlotsClient(s.functionModules,u.transport);l&&l.clearAllAds({slotId:t}),w(t)}catch(a){if(console.error("adblockify: Failed inside `handleAdSlot` function. Retrying in 1 second...\n",a),retryCounter(t,"increment"),retryCounter(t,"get")>5){console.error(`adblockify: Failed inside \`handleAdSlot\` function for 5th time. Giving up...
Slot id: ${t}.`),retryCounter(t,"clear");return}setTimeout(m,1*1e3,e)}S()},w=async e=>{try{const t=getSettingsClient(s.cache,s.functionModules,u.transport);if(!t)return;const a=y[0]===1&&y[1]>=2&&y[2]>=82?0n:"0";await t.updateAdServerEndpoint({slotIds:[e],url:"http://localhost/no/thanks"}),await t.updateStreamTimeInterval({slotId:e,timeInterval:a}),await t.updateSlotEnabled({slotId:e,enabled:!1}),await t.updateDisplayTimeInterval({slotId:e,timeInterval:a})}catch(t){console.error("adblockify: Failed inside `updateSlotSettings` function\n",t)}},M=async()=>{for(const e of f)w(e.slotId||e.slot_id)},E=e=>{try{n.inStreamApi.adsCoreConnector.subscribeToSlot(e,m)}catch(t){console.error("adblockify: Failed inside `subToSlot` function\n",t)}},_=()=>{const e=Array.from(document.querySelectorAll(".ReactModalPortal")),t=new MutationObserver(a=>{for(const l of a)if(l.addedNodes.length){const d=l.addedNodes[0];if(!d.classList.contains("GenericModal__overlay"))continue;const h=d.querySelector("iframe");if(!h)continue;const A=h?.contentWindow?.document.body;if(!A||!A.querySelector("[data-click-to-action-url*='/premium-promotional-offer-terms']"))continue;d.remove()}});for(const a of e)t.observe(a,{childList:!0})},v=async()=>{try{const e=JSON.parse(localStorage.getItem("spicetify-exp-features")||"{}");typeof e?.enableEsperantoMigration?.value<"u"&&(e.enableEsperantoMigration.value=!0),typeof e?.enableInAppMessaging?.value<"u"&&(e.enableInAppMessaging.value=!1),typeof e?.hideUpgradeCTA?.value<"u"&&(e.hideUpgradeCTA.value=!0),typeof e?.enablePremiumUserForMiniPlayer?.value<"u"&&(e.enablePremiumUserForMiniPlayer.value=!0),localStorage.setItem("spicetify-exp-features",JSON.stringify(e));const t={enableEsperantoMigration:!0,enableInAppMessaging:!1,hideUpgradeCTA:!0,enablePremiumUserForMiniPlayer:!0};if(Spicetify?.RemoteConfigResolver){const a=Spicetify.createInternalMap(t);Spicetify.RemoteConfigResolver.value.setOverrides(a)}else if(Spicetify.Platform?.RemoteConfigDebugAPI){const a=Spicetify.Platform.RemoteConfigDebugAPI;for(const[l,d]of Object.entries(t))await a.setOverride({source:"web",type:"boolean",name:l},d)}}catch(e){console.error("adblockify: Failed inside `enableExperimentalFeatures` function\n",e)}};k(),C(),u.subValues({keys:["ads","catalogue","product","type"]},()=>S()),v(),setTimeout(v,3*1e3),setTimeout(M,5*1e3)})();
